<!doctype html>
<html lang="es" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Manual de Usuario de CenaTrack</title>
  
  <!-- Tailwind CSS - Importado de landingpage.html -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  
  <link rel="shortcut icon" href="cenatrack.png" style="object-fit: contain;">

  <!-- Estilos base y fuentes personalizadas (conservados y adaptados de ambos archivos) -->
  <style>
    body {
      /* Base de landingpage.html */
      font-family: 'CenaTrackFont', 'Inter', sans-serif;
      background-color: #FDFBF8;
      color: #374151;
      /* Añadido para el header sticky */
      padding-top: 80px; /* Ajustar si la altura del header cambia */
    }

    /* Reglas de fuentes de la landing page, cruciales para la estética */
    p {
      font-family: 'Colombia Regular', sans-serif !important;
      font-size: 1.60rem !important;
      line-height: 1.6; /* Añadido para mejor legibilidad */
    }
     h2 {
      font-family: 'Colombia Bold', sans-serif !important;
      font-size: 2rem !important;
      margin-bottom: 1.25rem; /* Añadido para espaciado */
    }
    h3 {
      font-family: 'Colombia Bold', sans-serif !important;
      font-size: 1.90rem !important;
      margin-bottom: 1rem; /* Añadido para espaciado */
    }

    /* Estilos de hover de la landing page (header) */
    .nav-link {
      transition: color 0.3s, border-color 0.3s;
    }
    header .nav-link.active, header .nav-link:hover {
      color: #3182ce;
    }
    
    /* Estilos de la barra lateral de navegación */
    .sidebar-nav .nav-link {
        font-size: 1.5rem !important;
        font-family: 'Colombia Regular', sans-serif !important;
        font-weight: 600; /* semibold */
        color: #4b5563; /* text-gray-600 */
        padding: 0.25rem 1rem; /* py-1 pl-4 */
        display: block;
        border-left-width: 2px;
        border-color: transparent;
        margin-left: -1px; /* -ml-px */
    }
    .sidebar-nav .nav-link:hover {
        color: #2563eb; /* text-blue-600 */
        border-left-color: #93c5fd; /* border-blue-300 */
    }
    .sidebar-nav .nav-link.active {
        color: #2563eb; /* text-blue-600 */
        font-weight: 700; /* font-bold */
        border-left-color: #2563eb; /* border-blue-600 */
    }

    /* Estilo de "tarjeta" para el contenedor principal del contenido del manual */
    .feature-card {
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .feature-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    /* Definiciones de @font-face (conservadas) */
    @font-face {
      font-family: 'Colombia Regular';
      src: url('./fonts/Colombia-Regular.ttf') format('truetype');
      font-weight: 400;
      font-style: normal;
    }
    @font-face {
      font-family: 'Colombia Italic';
      src: url('./fonts/Colombia-Regular-Italic.ttf') format('truetype');
      font-weight: 400;
      font-style: italic;
    }
    @font-face {
      font-family: 'Colombia Bold';
      src: url('./fonts/Colombia-Bold.ttf') format('truetype');
      font-weight: 700;
      font-style: normal;
    }
    @font-face {
      font-family: 'Colombia Bold Italic';
      src: url('./fonts/Colombia-Bold-Italic.ttf') format('truetype');
      font-weight: 700;
      font-style: italic;
    }

    .font-colombia-regular {
      font-family: 'Colombia Regular', sans-serif;
      font-weight: 400;
    }
    .font-colombia-italic {
      font-family: 'Colombia Italic', sans-serif;
      font-style: italic;
      font-weight: 400;
    }
    .font-colombia-bold {
      font-family: 'Colombia Bold', sans-serif;
      font-weight: 700;
    }
    .font-colombia-bold-italic {
      font-family: 'Colombia Bold Italic', sans-serif;
      font-style: italic;
      font-weight: 700;
    }
    
    /* Clases de estilo para contenido del manual */
    .manual-content ul {
        list-style-type: disc;
        list-style-position: outside;
        padding-left: 1.75rem;
        margin-bottom: 1rem;
        font-size: 1.60rem !important; /* Forzar tamaño de p */
        font-family: 'Colombia Regular', sans-serif !important; /* Forzar fuente de p */
    }
    .manual-content ul li {
        margin-bottom: 0.5rem;
        line-height: 1.6;
    }
    .manual-content ol {
        list-style-type: decimal;
        list-style-position: outside;
        padding-left: 1.75rem;
        margin-bottom: 1rem;
        font-size: 1.60rem !important;
        font-family: 'Colombia Regular', sans-serif !important;
    }
    .manual-content ol li {
        margin-bottom: 0.5rem;
        line-height: 1.6;
    }
    .manual-content h4 {
        font-family: 'Colombia Bold', sans-serif !important;
        font-size: 1.75rem !important;
        color: #1f2937; /* text-gray-800 */
        margin-top: 1.5rem;
        margin-bottom: 0.75rem;
    }
    .manual-content table {
        width: 100%;
        text-align: left;
        border-collapse: collapse;
        margin-top: 1rem;
        margin-bottom: 1rem;
        font-size: 1.50rem !important; /* Ligeramente más pequeño para tablas */
    }
    .manual-content th, .manual-content td {
        padding: 0.75rem 1rem;
        border-bottom: 1px solid #e5e7eb; /* border-gray-200 */
        font-family: 'Colombia Bold', sans-serif !important;
        vertical-align: top;
        line-height: 1.6;
    }
    .manual-content thead {
        background-color: #f9fafb; /* bg-gray-50 */
    }
    .manual-content thead th {
        font-family: 'Colombia Bold', sans-serif !important;
        font-size: 1.50rem !important;
        color: #374151; /* text-gray-700 */
    }
    .manual-content a {
        color: #2563eb; /* text-blue-600 */
        text-decoration: none;
        transition: text-decoration 0.2s;
    }
    .manual-content a:hover {
        text-decoration: underline;
    }
    .manual-content a.btn {
        display: inline-block;
        background-color: #2563eb; /* bg-blue-600 */
        color: #ffffff !important; /* Forzar color blanco */
        font-family: 'Colombia Bold', sans-serif !important; /* Botones usan Inter */
        font-size: 1rem !important; /* Tamaño de fuente de botón estándar */
        font-weight: 700;
        padding: 0.75rem 1.5rem;
        border-radius: 9999px; /* rounded-full */
        transition: background-color 0.3s;
        text-decoration: none;
        margin-top: 1rem;
    }
    .manual-content a.btn:hover {
        background-color: #1d4ed8; /* bg-blue-700 */
        text-decoration: none;
    }
    .manual-content ul.check li {
      list-style-type: none;
      position: relative;
      padding-left: 2rem;
    }
    .manual-content ul.check li::before {
      content: '✓';
      position: absolute;
      left: 0;
      color: #22c55e; /* text-green-500 */
      font-weight: 700;
      font-size: 1.25rem;
      top: -2px;
    }

  </style>

</head>
<body class="antialiased">

  <!-- Header de landingpage.html (adaptado) -->
  <header id="header" class="bg-white/80 backdrop-blur-md fixed top-0 left-0 right-0 z-[1000] shadow-sm">
      <nav class="container mx-auto px-6 py-4 flex justify-between items-center z-[1000]">
          <a href="landingpage.html" class="text-[1.570rem] font-bold text-gray-800 transform hover:scale-110 transition duration-300 ease-in-out"><img src="cenatrack2.png" alt="CenaTrack Logo" style="height: 60px; width: auto;" loading="lazy"></a>
          <div class="hidden md:flex space-x-12 z-[1000]">
              <a href="index.html" class="nav-link text-black-900 font-bold font-colombia-bold text-[1.970rem] transform hover:scale-125 transition duration-300 ease-in-out">Inicio</a>
              <a href="#presentacion" class="nav-link text-black-900 font-bold font-colombia-bold text-[1.970rem] transform hover:scale-125 transition duration-300 ease-in-out">Presentación</a>
              <a href="#funciones" class="nav-link text-black-900 font-bold font-colombia-bold text-[1.970rem] transform hover:scale-125 transition duration-300 ease-in-out">Funciones</a>
              <a href="#roles" class="nav-link text-black-900 font-bold font-colombia-bold text-[1.970rem] transform hover:scale-125 transition duration-300 ease-in-out">Roles</a>
              <a href="#faq" class="nav-link text-black-900 font-bold font-colombia-bold text-[1.970rem] transform hover:scale-125 transition duration-300 ease-in-out">FAQ</a>
          </div>
          <button id="mobile-menu-button" class="md:hidden text-gray-700 focus:outline-none">
               <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
          </button>
      </nav>
      <!-- Menú móvil -->
      <div id="mobile-menu" class="hidden md:hidden px-8 pb-6 items-center justify-center bg-white/95 backdrop-blur-md">
           <a href="index.html" class="block py-2 nav-link text-black-900 font-bold font-colombia-bold mx-5 text-center">Inicio</a>
           <a href="#presentacion" class="block py-2 nav-link text-black-900 font-bold font-colombia-bold mx-5 text-center">Presentación</a>
           <a href="#funciones" class="block py-2 nav-link text-black-900 font-bold font-colombia-bold mx-5 text-center">Funciones</a>
           <a href="#roles" class="block py-2 nav-link text-black-900 font-bold font-colombia-bold mx-5 text-center">Roles</a>
           <a href="#faq" class="block py-2 nav-link text-black-900 font-bold font-colombia-bold mx-5 text-center">FAQ</a>
      </div>
  </header>
  
  <!-- Contenedor principal con layout de Tailwind -->
  <div class="container mx-auto px-6 py-16 md:py-24">

    <!-- Encabezado del Manual (Estilizado) -->
    <header id="manual-header" class="text-center mb-16">
      <h1 class="font-colombia-bold text-4xl md:text-5xl text-gray-800">Manual de Usuario</h1>
      <p class="text-2xl md:text-3xl font-colombia-regular text-blue-600 mt-2">CenaTrack</p>
      <p class="text-lg md:text-xl text-gray-600 mt-4 max-w-3xl mx-auto font-inter !font-normal ">
          Guía amigable paso a paso para el sistema de navegación y asistencia en tiempo real de la Central de Abastos de Cúcuta (Cenabastos).
      </p>
    </header>

    <!-- Layout de Grid de Tailwind -->
    <div class="lg:grid lg:grid-cols-4 lg:gap-12">
      
      <!-- Barra lateral de navegación pegajosa -->
      <aside class="hidden lg:block lg:col-span-1">
        <div class="sticky top-28 manual-content"> <!-- top-28 = 7rem = 112px (80px header + 32px gap) -->
          <h3 class="font-colombia-bold !text-2xl mb-4">Índice</h3>
          <ul class="space-y-2 border-l-2 border-gray-200 sidebar-nav">
            <li><a href="#presentacion" class="nav-link">1. Presentación</a></li>
            <li><a href="#descripcion" class="nav-link">2. Descripción</a></li>
            <li><a href="#requisitos" class="nav-link">3. Requisitos</a></li>
            <li><a href="#instalacion" class="nav-link">4. Instalación</a></li>
            <li><a href="#pantallas" class="nav-link">5. Pantallas</a></li>
            <li><a href="#funciones" class="nav-link">6. Funciones</a></li>
            <li><a href="#roles" class="nav-link">7. Roles</a></li>
            <li><a href="#faq" class="nav-link">8. FAQ</a></li>
            <li><a href="#soporte" class="nav-link">9. Soporte</a></li>
            <li><a href="#tecnico" class="nav-link">10. Técnico</a></li>
            <li><a href="#creditos" class="nav-link">11. Créditos</a></li>
          </ul>
          
          <!-- Contenido de la antigua barra lateral -->
          <div class="mt-10 p-6 bg-gray-50 rounded-lg border">
              <h3 class="font-colombia-bold !text-xl mb-3">Descargas</h3>
              <p class="!text-base !font-inter !font-normal !text-gray-700">Pide al autor el archivo .apk o enlaces a la appStore cuando este disponible.</p>
          </div>
        </div>
      </aside>

      <!-- Contenido Principal -->
      <main class="lg:col-span-3 manual-content">
        <!-- Contenedor único para todo el contenido del manual -->
        <div class="bg-white p-6 md:p-10 rounded-lg shadow-lg feature-card">

          <section id="presentacion" class="py-8 border-b border-gray-200">
            <h2>1. Presentación del Manual</h2>
            <p>¡Bienvenido al Manual de Usuario de <strong>CenaTrack</strong>! Este documento te guiará para instalar, configurar y usar la aplicación dentro de la Central de Abastos de Cúcuta (Cenabastos). Está pensado para usuarios con distintos niveles y roles: compradores, campesinos, transportadores y administradores.</p>
          </section>

          <section id="descripcion" class="py-8 border-b border-gray-200">
            <h2>2. Descripción general</h2>
            <p><strong>CenaTrack</strong> es una app móvil multiplataforma que ofrece orientación, información y asistencia en tiempo real dentro de Cenabastos. Su propósito es facilitar la localización de galpones, optimizar desplazamientos y ofrecer soporte mediante un asistente virtual llamado <em>CenaBot</em> (o <em>Celeste</em> en algunas versiones).</p>

            <h3>Funcionalidades principales</h3>
            <ul>
              <li>Mapa interactivo con galpones, rutas y zonas de carga.</li>
              <li>Asistente virtual (CenaBot) para preguntas frecuentes y rutas.</li>
              <li>Geolocalización en tiempo real dentro del recinto.</li>
              <li>Autenticación segura (Google + 2FA via Clerk).</li>
              <li>Modo invitado y modo offline básico.</li>
            </ul>
          </section>

          <section id="requisitos" class="py-8 border-b border-gray-200">
            <h2>3. Requisitos del sistema</h2>
            <p>Antes de usar la app, verifica lo siguiente:</p>
            <ul class="check">
              <li>Android 9+ o iOS 13+.</li>
              <li>Conexión a internet (mínimo 3 Mbps recomendado para funciones en tiempo real).</li>
              <li>GPS activado y permisos de localización concedidos.</li>
              <li>Al menos 200 MB de espacio libre.</li>
              <li>Cuenta Google para acceso completo (opcional: modo invitado).</li>
            </ul>
          </section>

          <section id="instalacion" class="py-8 border-b border-gray-200">
            <h2>4. Instalación y acceso</h2>
            <h4>Paso 1: Descargar la app</h4>
            <ol>
              <li>Abre Google Play (Android) o App Store (iOS).</li>
              <li>Busca "<strong>CenaTrack</strong>" y presiona <em>Instalar</em>.</li>
              <li>Abre la app desde el ícono una vez instalada.</li>
            </ol>

            <h4>Paso 2: Carrusel de bienvenida</h4>
            <p>Al iniciar por primera vez verás 3 pantallas de introducción. Puedes deslizar o presionar <strong>Saltar</strong> para ir al inicio. En la última pantalla pulsa <strong>Empezar</strong>.</p>

            <h4>Paso 3: Crear cuenta o entrar como invitado</h4>
            <p>Puedes iniciar sesión con Google (recomendado) o usar el modo invitado con funciones limitadas.</p>

            <h4>Paso 4: Verificación 2FA</h4>
            <p>Si entras con Google, recibirás un código por correo para completar la verificación en dos pasos (Clerk).</p>
          </section>

          <section id="pantallas" class="py-8 border-b border-gray-200">
            <h2>5. Pantallas principales y navegación</h2>

            <h4>Pantalla de inicio (Home)</h4>
            <p>Desde aquí verás tu saludo, el mapa principal, campo de búsqueda y tus rutas recientes.</p>

            <h4>Mapa interactivo</h4>
            <ul>
              <li>Usa gestos para acercar/alejar.</li>
              <li>Toca marcadores para ver detalles del galpón.</li>
              <li>Filtra por categorías (frutas, granos, transporte, etc.).</li>
              <li>Pulsa <strong>Ruta</strong> para obtener instrucciones paso a paso.</li>
            </ul>

            <h4>Asistente virtual (CenaBot / Celeste)</h4>
            <p>Escribe o selecciona preguntas frecuentes para obtener respuestas contextualizadas según tu ubicación y rol.</p>

            <h4>Perfil y configuración</h4>
            <p>Desde el ícono de perfil puedes editar datos, cerrar sesión y ajustar notificaciones.</p>
          </section>

          <section id="funciones" class="py-8 border-b border-gray-200">
            <h2>6. Funciones destacadas</h2>
            <div class="overflow-x-auto">
              <table>
                <thead>
                  <tr><th>Función</th><th>Descripción</th><th>Disponible para</th></tr>
                </thead>
                <tbody>
                  <tr><td>Inicio de sesión con Google</td><td>Acceso rápido con cuenta Google</td><td>Todos</td></tr>
                  <tr><td>Verificación 2FA</td><td>Seguridad extra via Clerk</td><td>Usuarios registrados</td></tr>
                  <tr><td>Mapa interactivo</td><td>Visualización de galpones y rutas</td><td>Todos</td></tr>
                  <tr><td>Asistente virtual</td><td>Respuestas y guías</td><td>Todos</td></tr>
                  <tr><td>Modo invitado</td><td>Explorar sin registrarse</td><td>Invitados</td></tr>
                  <tr><td>Rutas personalizadas</td><td>Indicaciones paso a paso</td><td>Usuarios registrados</td></tr>
                </tbody>
              </table>
            </div>
          </section>

          <section id="roles" class="py-8 border-b border-gray-200">
            <h2>7. Roles de usuario</h2>
            <h4>Compradores</h4>
            <p>Buscan productos y locales; usan rutas y el asistente para encontrar ofertas o servicios.</p>

            <h4>Transportadores</h4>
            <p>Necesitan zonas de carga/descarga, rutas optimizadas y horarios de acceso.</p>

            <h4>Administradores</h4>
            <p>Supervisan actividad, reciben PQRS y gestionan contenido desde el panel administrativo (funciones extendidas en versiones futuras).</p>
          </section>

          <section id="faq" class="py-8 border-b border-gray-200">
            <h2>8. Preguntas frecuentes (FAQ)</h2>
            <ol>
              <li><strong>¿Necesito internet?</strong> Sí para mapa y asistente; hay modo offline básico.</li>
              <li><strong>¿No tengo Google?</strong> Usa modo invitado con funciones limitadas.</li>
              <li><strong>¿Cómo activo ubicación?</strong> Ajustes del teléfono → Ubicación → Permitir a CenaTrack.</li>
              <li><strong>Mapa en blanco?</strong> Revisa tu conexión, reinicia la app o limpia caché.</li>
              <li><strong>¿Fuera de Cenabastos?</strong> Actualmente no; la app está diseñada para Cenabastos.</li>
            </ol>
          </section>

          <section id="soporte" class="py-8 border-b border-gray-200">
            <h2>9. Solución de problemas comunes</h2>
            <div class="overflow-x-auto">
              <table>
                <thead><tr><th>Problema</th><th>Causa posible</th><th>Solución</th></tr></thead>
                <tbody>
                  <tr><td>GPS no detecta</td><td>Permisos o GPS desactivado</td><td>Activa ubicación y permisos</td></tr>
                  <tr><td>Asistente no responde</td><td>Conexión o mantenimiento</td><td>Intentar más tarde</td></tr>
                  <tr><td>Verificación no llega</td><td>Retraso de correo</td><td>Revisar spam o solicitar nuevo código</td></tr>
                  <tr><td>No veo galpones</td><td>Carga lenta</td><td>Esperar o reiniciar app</td></tr>
                  <tr><td>App no abre</td><td>Instalación corrupta</td><td>Reinstalar aplicación</td></tr>
                </tbody>
              </table>
            </div>
          </section>

          <section id="tecnico" class="py-8 border-b border-gray-200">
            <h2>10. Información técnica resumida</h2>
            <p>Resumen técnico pensado para administradores y soporte.</p>

            <h4>Arquitectura</h4>
            <p>React Native + Expo (móvil), Node.js (backend), NeonDB/Postgres (datos), Clerk (auth), Google Generative AI / Gemini (chatbot), Google Maps / Geoapify (mapas).</p>

            <h4>Entorno de desarrollo</h4>
            <ul>
              <li>Editor recomendado: Visual Studio Code</li>
              <li>Control de versiones: Git/GitHub</li>
              <li>Pruebas SQA: unitarias, integración, rendimiento</li>
            </ul>

            <h4>Seguridad</h4>
            <p>Claves en .env, comunicación TLS/SSL, normas ISO 27001/27002 y roles con permisos definidos.</p>

          </section>

          <section id="creditos" class="py-8">
            <h2>11. Créditos y contacto</h2>
            <p><strong>Equipo:</strong> Cristhian Camilo Durán, Jesús Duván Pérez, Juan Diego Monsalve, Jesús Antonio García.</p>
            <p><strong>Instructor:</strong> Mario Alexander Velasco Vera</p>
            <p><strong>Soporte:</strong> cenatrack.soporte@gmail.com</p>
            <p><a class="btn" href="#header">Volver arriba</a></p>
          </section>
        </div>
      </main>

    </div>

  </div>

  <!-- Footer de landingpage.html -->
  <footer class="w-full bg-gray-800 flex flex-col md:flex-row justify-between items-center px-4 md:px-16 py-10 gap-8">
    <!-- Card: Logo + Text -->
    <div class="flex flex-col md:flex-row items-center md:items-start gap-4 md:gap-6 w-full md:w-1/2 max-w-xl">
      <img src="cenatrack1.png" alt="Logo CenaTrack" class="w-24 h-24 object-contain rounded-lg shadow-md bg-white p-2" />
      <div>
        <h5 class="text-lg font-bold text-white font-inter mb-1">CenaTrack</h5>
        <p class="text-sm text-white font-inter mb-2 max-w-xs text-center md:text-left">
          Diseñado y construido con todo el amor del mundo por el equipo de 
          <a href="#" class="team text-blue-300 hover:font-inter hover:text-base">CenaTrack</a> con la ayuda de nuestros instructores y todo el equipo SENA.
        </p>
        <p class="text-sm text-white font-inter mb-2 max-w-xs text-center md:text-left">&copy; 2025 CenaTrack. Todos los derechos reservados.</p>
      </div>
    </div>
    <!-- Footer Form -->
    <form action="#" method="POST" class="flex flex-col items-center w-full md:w-1/2 max-w-xl gap-3">
      <div class="flex flex-col sm:flex-row gap-3 w-full">
        <input type="text" name="NOMBRES_Y_APELLIDOS" placeholder="Ingresa tu nombre o apodo" required
          class="w-full sm:w-1/2 px-3 py-2 border-b-2 border-white bg-transparent text-white placeholder-white  font-inter focus:outline-none focus:border-white  transition" />
        <input type="email" name="CORREO_ELECTRONICO" placeholder="Ingresa tu correo electrónico" required
          class="w-full sm:w-1/2 px-3 py-2 border-b-2 border-white bg-transparent text-white placeholder-white font-inter focus:outline-none focus:border-white transition" />
      </div>
      <textarea name="SUGERENCIAS" rows="3" maxlength="500" placeholder="¿En qué podemos mejorar? (Máximo 500 caracteres)" required
        class="w-full px-3 py-2 border border-gray-600 bg-gray-100 rounded-lg font-inter mt-1 resize-vertical focus:outline-none focus:border-white  placeholder-gray-800 transition"></textarea>
      <button type="submit" class="bg-white text-gray-800 font-bold text-lg px-8 py-2 rounded-lg mt-2 w-full md:w-1/2 hover:bg-gray-200 transition">Ingresar</button>
    </form>
  </footer>

  <!-- Scripts de landingpage.html (Solo menú móvil y scroll-spy) -->
  <script>
      document.addEventListener('DOMContentLoaded', () => {
          // Lógica del menú móvil
          const mobileMenuButton = document.getElementById('mobile-menu-button');
          const mobileMenu = document.getElementById('mobile-menu');
          mobileMenuButton.addEventListener('click', () => {
              mobileMenu.classList.toggle('hidden');
          });

          // Lógica de Scroll-spy para los enlaces de navegación
          const navLinks = document.querySelectorAll('.nav-link');
          const sections = document.querySelectorAll('main section, header[id="manual-header"]'); // Observar secciones y el header del manual
          
          // Ajuste para la altura del header sticky
          const headerOffset = document.getElementById('header')?.offsetHeight || 80;

          const observerOptions = {
              root: null,
              rootMargin: `-${headerOffset}px 0px -40% 0px`, // Ajustar el rootMargin y bottom
              threshold: 0 // Activar tan pronto como entre en el área
          };

          const observer = new IntersectionObserver((entries) => {
              let activeId = null;
              
              // Encontrar la sección más visible o la primera que esté intersectando
              const visibleEntries = entries.filter(e => e.isIntersecting);
              if (visibleEntries.length > 0) {
                  // Dar prioridad a la que tenga mayor ratio, o la primera de la lista
                  visibleEntries.sort((a, b) => b.intersectionRatio - a.intersectionRatio);
                  activeId = visibleEntries[0].target.getAttribute('id');
              }

              // Si se detectó una sección activa, actualizar enlaces
              navLinks.forEach(link => {
                  const linkHref = link.getAttribute('href');
                  if (linkHref && activeId && linkHref.endsWith(`#${activeId}`)) {
                      link.classList.add('active');
                  } else {
                      link.classList.remove('active');
                  }
              });
              
          }, observerOptions);
          
          sections.forEach(section => {
              if (section) {
                  observer.observe(section);
              }
          });
          
          // Cerrar menú móvil al hacer clic en un enlace
          mobileMenu.querySelectorAll('a').forEach(link => {
              link.addEventListener('click', () => {
                  mobileMenu.classList.add('hidden');
              });
          });
      });
  </script>

</body>
</html>

